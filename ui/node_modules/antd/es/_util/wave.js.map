{"version":3,"sources":["_util/wave.jsx"],"names":["React","findDOMNode","TransitionEvents","raf","ConfigConsumer","styleForPesudo","isHidden","element","process","env","NODE_ENV","offsetParent","Wave","arguments","animationStart","destroy","onClick","node","waveColor","className","indexOf","insertExtraNode","props","extraNode","document","createElement","attributeName","getAttributeName","setAttribute","isNotGrey","test","csp","nonce","style","borderColor","innerHTML","body","contains","appendChild","addStartEventListener","onTransitionStart","addEndEventListener","onTransitionEnd","bindAnimationEvent","getAttribute","e","target","tagName","resetEffect","getComputedStyle","getPropertyValue","clickWaveTimeoutId","window","setTimeout","cancel","animationStartId","addEventListener","removeEventListener","animationName","renderWave","children","color","match","Element","removeExtraStyleNode","removeChild","removeStartEventListener","removeEndEventListener","nodeType","instance","clearTimeout","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport TransitionEvents from 'css-animation/lib/Event';\nimport raf from '../_util/raf';\nimport { ConfigConsumer } from '../config-provider';\nlet styleForPesudo;\n// Where el is the DOM element you'd like to test for visibility\nfunction isHidden(element) {\n    if (process.env.NODE_ENV === 'test') {\n        return false;\n    }\n    return !element || element.offsetParent === null;\n}\nexport default class Wave extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.animationStart = false;\n        this.destroy = false;\n        this.onClick = (node, waveColor) => {\n            if (!node || isHidden(node) || node.className.indexOf('-leave') >= 0) {\n                return;\n            }\n            const { insertExtraNode } = this.props;\n            this.extraNode = document.createElement('div');\n            const extraNode = this.extraNode;\n            extraNode.className = 'ant-click-animating-node';\n            const attributeName = this.getAttributeName();\n            node.setAttribute(attributeName, 'true');\n            // Not white or transparnt or grey\n            styleForPesudo = styleForPesudo || document.createElement('style');\n            if (waveColor &&\n                waveColor !== '#ffffff' &&\n                waveColor !== 'rgb(255, 255, 255)' &&\n                this.isNotGrey(waveColor) &&\n                !/rgba\\(\\d*, \\d*, \\d*, 0\\)/.test(waveColor) && // any transparent rgba color\n                waveColor !== 'transparent') {\n                // Add nonce if CSP exist\n                if (this.csp && this.csp.nonce) {\n                    styleForPesudo.nonce = this.csp.nonce;\n                }\n                extraNode.style.borderColor = waveColor;\n                styleForPesudo.innerHTML = `html body { --antd-wave-shadow-color: ${waveColor}; }`;\n                if (!document.body.contains(styleForPesudo)) {\n                    document.body.appendChild(styleForPesudo);\n                }\n            }\n            if (insertExtraNode) {\n                node.appendChild(extraNode);\n            }\n            TransitionEvents.addStartEventListener(node, this.onTransitionStart);\n            TransitionEvents.addEndEventListener(node, this.onTransitionEnd);\n        };\n        this.bindAnimationEvent = (node) => {\n            if (!node ||\n                !node.getAttribute ||\n                node.getAttribute('disabled') ||\n                node.className.indexOf('disabled') >= 0) {\n                return;\n            }\n            const onClick = (e) => {\n                // Fix radio button click twice\n                if (e.target.tagName === 'INPUT' || isHidden(e.target)) {\n                    return;\n                }\n                this.resetEffect(node);\n                // Get wave color from target\n                const waveColor = getComputedStyle(node).getPropertyValue('border-top-color') || // Firefox Compatible\n                    getComputedStyle(node).getPropertyValue('border-color') ||\n                    getComputedStyle(node).getPropertyValue('background-color');\n                this.clickWaveTimeoutId = window.setTimeout(() => this.onClick(node, waveColor), 0);\n                raf.cancel(this.animationStartId);\n                this.animationStart = true;\n                // Render to trigger transition event cost 3 frames. Let's delay 10 frames to reset this.\n                this.animationStartId = raf(() => {\n                    this.animationStart = false;\n                }, 10);\n            };\n            node.addEventListener('click', onClick, true);\n            return {\n                cancel: () => {\n                    node.removeEventListener('click', onClick, true);\n                },\n            };\n        };\n        this.onTransitionStart = (e) => {\n            if (this.destroy)\n                return;\n            const node = findDOMNode(this);\n            if (!e || e.target !== node) {\n                return;\n            }\n            if (!this.animationStart) {\n                this.resetEffect(node);\n            }\n        };\n        this.onTransitionEnd = (e) => {\n            if (!e || e.animationName !== 'fadeEffect') {\n                return;\n            }\n            this.resetEffect(e.target);\n        };\n        this.renderWave = ({ csp }) => {\n            const { children } = this.props;\n            this.csp = csp;\n            return children;\n        };\n    }\n    isNotGrey(color) {\n        const match = (color || '').match(/rgba?\\((\\d*), (\\d*), (\\d*)(, [\\.\\d]*)?\\)/);\n        if (match && match[1] && match[2] && match[3]) {\n            return !(match[1] === match[2] && match[2] === match[3]);\n        }\n        return true;\n    }\n    getAttributeName() {\n        const { insertExtraNode } = this.props;\n        return insertExtraNode ? 'ant-click-animating' : 'ant-click-animating-without-extra-node';\n    }\n    resetEffect(node) {\n        if (!node || node === this.extraNode || !(node instanceof Element)) {\n            return;\n        }\n        const { insertExtraNode } = this.props;\n        const attributeName = this.getAttributeName();\n        node.setAttribute(attributeName, 'false'); // edge has bug on `removeAttribute` #14466\n        this.removeExtraStyleNode();\n        if (insertExtraNode && this.extraNode && node.contains(this.extraNode)) {\n            node.removeChild(this.extraNode);\n        }\n        TransitionEvents.removeStartEventListener(node, this.onTransitionStart);\n        TransitionEvents.removeEndEventListener(node, this.onTransitionEnd);\n    }\n    removeExtraStyleNode() {\n        if (styleForPesudo) {\n            styleForPesudo.innerHTML = '';\n        }\n    }\n    componentDidMount() {\n        const node = findDOMNode(this);\n        if (!node || node.nodeType !== 1) {\n            return;\n        }\n        this.instance = this.bindAnimationEvent(node);\n    }\n    componentWillUnmount() {\n        if (this.instance) {\n            this.instance.cancel();\n        }\n        if (this.clickWaveTimeoutId) {\n            clearTimeout(this.clickWaveTimeoutId);\n        }\n        this.destroy = true;\n    }\n    render() {\n        return <ConfigConsumer>{this.renderWave}</ConfigConsumer>;\n    }\n}\n"],"file":"wave.js"}